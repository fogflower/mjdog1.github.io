---
layout: post
title: 读wireshark数据包分析实战之第六章---通用底层网络协议
categories: [cate1, cate2]
description: some word here
keywords: keyword1, keyword2
---
#读wireshark数据包分析实战之第六章---通用底层网络协议

这一章主要是集中在OSI分层模型中从第1层到第四层的底层协议。（作为一个回顾当然也可以作为一个开始，内容较为实用）


## 地址解析协议
网络里面存在着逻辑地址和物理地址。逻辑地址用在不同的网络直接以及没有直接相连的设备之间进行通信。而物力地址则用在单一网络中交换机直接进行通信。大多数情况下都是两者共同起作用的。

TCP/IP网络（基于ipv4）中用来将IP地址解析为MAC地址的过程叫做地址解析协议（Address Resolution Protocol）。它的解析包含两个数据包：一个ARP请求与一个ARP响应。

这里有一个故事,有个机器A，他只知道小伙伴的IP地址，想通过arp来知道小伙伴的物理地址。首先他给周围的人广播，“大家好，我是A,我的IP地址是，XX.XX.XX.XX,MAC地址是XX.XX.XX.XX。我想要一个IP地址为XX.XX.XX.XX小伙伴的MAC地址，谁有这个IP地址，可否回复我MAC地址”。当不是这个IP地址的主机则丢弃这个数据包，拥有这个IP地址的设备则返回一个ARP响应。大致就是返回我是IP为XX.XX.XX.XX的，我的MAC是XX.XX.XX.XX。

### ARP头结构

1. 硬件类型：数据链路层使用的类型数据。大多数情况下，都是以太网。
2. 协议类型：ARP请求的高层协议。如IP协议
3. 硬件地址长度：正在使用的硬件地址的长度(单位为字节)（一般为6个字节）
4. 协议地址长度：对于指定协议类型使用的逻辑地址的长度。（单位字节）一般四个字节。
5. 操作(opcode)：ARP数据包的功能:0x001表示请求，0x002表示相应
6. 发送方硬件地址：发送方MAC地址
7. 发送方协议地址：发送方的高层协议地址即IP地址。
8. 目标硬件地址：目标接收方的硬件地址。（ARP请求中为0）
9. 目标协议地址：目标接收方的高层协议地址。（IP地址）
![@ARP请求数据包|center](./arp图片.png)

在图中可以看到1时，发送的是一个广播报，这个数据的源地址2就是我们的MAC地址。从3可以得知我们的操作码（opcode）为请求，即发送ARP请求。在3下面列出了所有的源IP地址与MAC地址，以及目的的IP地址以及未知的MAC地址。

![@ARP返回|center]](./arg返回.png)

图片中列举了返回的ARP文件，可以看到1发生了改变，发送方和接收方出现了交换。最重要的变化是在2中，opcode编程了0x0002表示响应包。3也发生了发送方与接收方的转换。

还有一个小点就是存在无偿的ARP转发：一般都出现在一个主机的IP地址发生改变，原先的MAC地址与IP的地址映射发生改变，需要更新这些映射的时候需要进行所谓的无偿ARP转发。

## 互联网协议
## IP

## TCP 

## 用户数据报协议

## 互联网控制协议

| Col1      |     Col2 |   Col3   | dajia |
| :-------- | --------:| ------:    | --		 |
| field1    |   field2 |  field3  |大家好  |
